2024-07-22 03:32:25,543 - DEBUG - Loading model configuration from /home/heesters/projects/def-sfabbro/heesters/github/sky_embeddings/configs/jepa_test.ini
2024-07-22 03:32:25,804 - INFO - Using Torch version: 2.3.0 with CUDA version 12.2.
2024-07-22 03:32:25,804 - INFO - Using a cuda device with 1 GPU(s).
2024-07-22 03:32:25,809 - INFO - From rank 0/0: initializing process group..
2024-07-22 03:32:25,812 - INFO - From rank 0/0: distributed training available: True and initialized: True
2024-07-22 03:32:25,812 - INFO - From rank 0/0: World size: 1; Rank: 0
2024-07-22 03:32:25,814 - INFO - Creating model: jepa_test
2024-07-22 03:32:25,814 - INFO - Configuration:
2024-07-22 03:32:25,814 - INFO - DATA
2024-07-22 03:32:25,814 - INFO -   train_data_paths: ['/project/rrg-kyi/astro/hsc/pdr3_dud/']
2024-07-22 03:32:25,814 - INFO -   bands: ['G', 'I', 'R', 'Y', 'Z', 'NB0387', 'NB0816', 'NB0921', 'NB1010']
2024-07-22 03:32:25,814 - INFO -   min_bands: 9
2024-07-22 03:32:25,814 - INFO -   cutouts_per_tile: 1024
2024-07-22 03:32:25,814 - INFO -   img_size: 64
2024-07-22 03:32:25,814 - INFO -   val_data_file: HSC_dud_galaxy_GIRYZ7610_64_new.h5
2024-07-22 03:32:25,814 - INFO -   pos_channel: False
2024-07-22 03:32:25,814 - INFO -   lp_class_data_file: HSC_dud_simple_classifier_data_GIRYZ7610_64.h5
2024-07-22 03:32:25,814 - INFO -   lp_regress_data_file: HSC_dud_simple_regressor_data_GIRYZ7610_64.h5
2024-07-22 03:32:25,814 - INFO -   use_calexp: False
2024-07-22 03:32:25,815 - INFO -   pixel_mean: 0.0
2024-07-22 03:32:25,815 - INFO -   pixel_std: 1.0
2024-07-22 03:32:25,815 - INFO -   lp_combine: central
2024-07-22 03:32:25,815 - INFO - TRAINING
2024-07-22 03:32:25,815 - INFO -   batch_size: 64
2024-07-22 03:32:25,815 - INFO -   ema: [0.996, 1.0]
2024-07-22 03:32:25,815 - INFO -   total_batch_iters: 1000000.0
2024-07-22 03:32:25,815 - INFO -   warmup_ratio: 1.0e-5
2024-07-22 03:32:25,815 - INFO -   weight_decay: 0.04
2024-07-22 03:32:25,815 - INFO -   final_weight_decay: 0.4
2024-07-22 03:32:25,815 - INFO -   loss_fn: smooth_l1_loss
2024-07-22 03:32:25,815 - INFO -   start_lr: 0.0002
2024-07-22 03:32:25,815 - INFO -   ref_lr: 0.001
2024-07-22 03:32:25,815 - INFO -   final_lr: 1.0e-06
2024-07-22 03:32:25,815 - INFO -   final_lr_factor: 10000000.0
2024-07-22 03:32:25,815 - INFO -   norm_pix_loss: False
2024-07-22 03:32:25,815 - INFO -   use_bfloat16: True
2024-07-22 03:32:25,815 - INFO - MASK
2024-07-22 03:32:25,815 - INFO -   allow_overlap: False
2024-07-22 03:32:25,815 - INFO -   aspect_ratio_targets: [0.75, 1.5]
2024-07-22 03:32:25,815 - INFO -   min_keep: 5
2024-07-22 03:32:25,815 - INFO -   num_enc_masks: 1
2024-07-22 03:32:25,815 - INFO -   num_pred_masks: 4
2024-07-22 03:32:25,815 - INFO -   enc_mask_scale: [0.85, 1.0]
2024-07-22 03:32:25,815 - INFO -   pred_mask_scale: [0.15, 0.2]
2024-07-22 03:32:25,815 - INFO -   max_mask_ratio: 0.9
2024-07-22 03:32:25,815 - INFO -   mask_ratio: 0.75
2024-07-22 03:32:25,815 - INFO - ARCHITECTURE
2024-07-22 03:32:25,815 - INFO -   num_channels: 9
2024-07-22 03:32:25,815 - INFO -   patch_size: 8
2024-07-22 03:32:25,815 - INFO -   model_type: jepa_vit_small
2024-07-22 03:32:25,815 - INFO -   pred_depth: 4
2024-07-22 03:32:25,816 - INFO -   pred_emb_dim: 192
2024-07-22 03:32:25,816 - INFO -   attn_pool: False
2024-07-22 03:32:25,816 - INFO -   ra_dec: False
2024-07-22 03:32:25,816 - INFO -   embed_dim: 1024
2024-07-22 03:32:25,816 - INFO - LOGGING
2024-07-22 03:32:25,816 - INFO -   level: DEBUG
2024-07-22 03:32:25,816 - INFO - Notes
2024-07-22 03:32:25,816 - INFO -   comment: Initial I-JEPA training.
2024-07-22 03:32:28,071 - INFO - Using AdamW
2024-07-22 03:32:28,073 - INFO - Starting fresh model to train...
2024-07-22 03:32:28,101 - INFO - From rank 0/0: initializing models..
2024-07-22 03:32:28,433 - INFO - From rank 0/0: models initialized.
2024-07-22 03:32:28,477 - INFO - Found 168 patches with at least 9 of the ['G', 'I', 'R', 'Y', 'Z', 'NB0387', 'NB0816', 'NB0921', 'NB1010'] bands.
2024-07-22 03:32:28,479 - INFO - Training the network with a batch size of 64 per GPU ...
2024-07-22 03:32:28,479 - INFO - Progress will be displayed every 1 batch iterations and the model will be saved every 10.0 minutes.
2024-07-22 03:34:36,250 - INFO - Current iteration: 1
2024-07-22 03:34:36,251 - INFO - Iter: 1; learning rate: 0.00028000000000000003
2024-07-22 03:34:38,224 - INFO - loss is: 0.4430372416973114, of datatype: torch.float32
2024-07-22 03:34:39,470 - INFO - Performing validation at iteration 1
