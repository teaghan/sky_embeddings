[DATA]
update_tiles = True
min_bands = 5
processed_file = /home/heesters/project/def-sfabbro/heesters/github/sky_embeddings/processed_tiles.txt
exclude_processed = True
cutouts_per_tile = 10000
img_size = 64
queue_length_datastream = 2
val_data_file = /home/heesters/projects/def-sfabbro/a4ferrei/data/dr5_eval_set_validation.h5
off_limit_tiles = [(285, 281)]
lp_regress_data_file = /home/heesters/projects/def-sfabbro/a4ferrei/data/dr5_eval_set_redshift_6k_may2024.h5
pos_channel = False
lp_combine = central
use_calexp = True
survey = UNIONS

[TRAINING]
batch_size = 64
total_batch_iters = 100000000.0
max_mask_ratio = 0.9
norm_pix_loss = True
weight_decay = 0.0
init_lr = 0.01
final_lr_factor = 10000000.0
loss_fn = mse

[ARCHITECTURE]
num_channels = 5
pixel_mean = 0.0
pixel_std = 1.0
embed_dim = 768
pred_depth = 12
pred_emb_dim = 384
patch_size = 8
model_type = jepa
attn_pool = False
ra_dec = False
use_bfloat16 = False
do_norm = True
pixel_mean = (0. , 0. , 0. , 0. , 0.)
pixel_std = (1. , 1. , 1. , 1. , 1.)

[MASK]
allow_overlap = False
num_enc_masks = 1
num_pred_masks = 4
min_keep = 10
enc_mask_scale = (0.85, 1.0)
pred_mask_scale = (0.15, 0.2)
aspect_ratio_targets = (0.75, 1.5)

[OPTIMIZATION]
ema = (0.996, 1.0)
ipe_scale = 1.0
weight_decay = 0.04
final_weight_decay = 0.4
epochs = 300
warmup = 40
start_lr = 0.0002
lr = 0.001
final_lr = 1.0e-6

[LOGGING]
level = DEBUG
